{"componentChunkName":"component---src-templates-post-js","path":"/blog/add-custom-operators-to-typeorm/","result":{"data":{"markdownRemark":{"html":"<p>TypeORM is an ORM that can run in NodeJS, Browser, Cordova, PhoneGap, Ionic, React Native, NativeScript, Expo, and Electron platforms and can be used with TypeScript and JavaScript (ES5, ES6, ES7, ES8). Its goal is to always support the latest JavaScript features and provide additional features that help you to develop any kind of application that uses databases - from small applications with a few tables to large scale enterprise applications with multiple databases.</p>\n<p>TypeORM supports both Active Record and Data Mapper patterns, unlike all other JavaScript ORMs currently in existence, which means you can write high quality, loosely coupled, scalable, maintainable applications the most productive way.</p>\n<p>TypeORM is highly influenced by other ORMs, such as Hibernate, Doctrine and Entity Framework.</p>\n<p>While the framework gives you many features out of the box, it also gives you the ability to make custom operators which it might be lacking for repository . One of the operators that I use but didn't find in typeorm was ILike operator. For those who don't know what ILike operator doesn in sql is the same thing as Like operator but is case insensitive.</p>\n<p>To make a new operator in typeorm for repository pattern is pretty straight forward,</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Connection<span class=\"token punctuation\">,</span> FindOperator<span class=\"token punctuation\">,</span> FindOperatorType <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"typeorm\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">FindOperatorWithExtras<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span></span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">FindOperator<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>\n    type<span class=\"token operator\">:</span> FindOperatorType <span class=\"token operator\">|</span> <span class=\"token string\">\"ilike\"</span><span class=\"token punctuation\">,</span>\n    value<span class=\"token operator\">:</span> FindOperator<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span> <span class=\"token operator\">|</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">,</span>\n    useParameter<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span><span class=\"token punctuation\">,</span>\n    multipleParameters<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// @ts-ignore</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">,</span> useParameter<span class=\"token punctuation\">,</span> multipleParameters<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token function\">toSql</span><span class=\"token punctuation\">(</span>\n    connection<span class=\"token operator\">:</span> Connection<span class=\"token punctuation\">,</span>\n    aliasPath<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span>\n    parameters<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// @ts-ignore</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_type <span class=\"token operator\">===</span> <span class=\"token string\">\"ilike\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>aliasPath<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> ILIKE </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>parameters<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">toSql</span><span class=\"token punctuation\">(</span>connection<span class=\"token punctuation\">,</span> aliasPath<span class=\"token punctuation\">,</span> parameters<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/**\n * Find Options Operator.\n * Example: { someField: Like(\"%some string%\") }\n */</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token generic-function\"><span class=\"token function\">ILike</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span>\n  value<span class=\"token operator\">:</span> <span class=\"token constant\">T</span> <span class=\"token operator\">|</span> FindOperator<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> FindOperatorWithExtras<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FindOperatorWithExtras</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ilike\"</span><span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>In the example above, we are making ILike operator which is not available in typeorm by default.</p>","excerpt":"TypeORM is an ORM that can run in NodeJS, Browser, Cordova, PhoneGap, Ionic, React Native, NativeScript, Expo, and Electron platforms andâ€¦","tableOfContents":"","frontmatter":{"title":"Add custom operators to typeorm","date":"2019-02-12T00:00:00.000Z","slug":"/blog/add-custom-operators-to-typeorm/","tags":["nodejs","typescript"],"cover_image":{"publicURL":"/static/8f88d97f7da2ce95edf9759c8d735de8/cover.png"}}}},"pageContext":{}},"staticQueryHashes":["3115057458"],"slicesMap":{}}